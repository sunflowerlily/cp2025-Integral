# 计算物理实验第十一周：高斯积分和物理应用

本系列实验包含五个编程项目，旨在探索和实践数值微分和数值积分的不同方法。你将使用Python编程语言实现各种数值计算方法，并分析它们的精度和适用场景。

## 学习目标

完成本系列实验后，你将能够：

* 理解并实现中心差分法和Richardson外推法进行数值微分
* 比较不同数值微分方法的精度和稳定性
* 实现梯形法则和Simpson法则进行数值积分
* 应用数值积分方法处理实际数据(如速度-时间数据)
* 分析不同数值方法的误差来源和收敛特性

## 实验概览

本次实验包含以下五个独立的编程项目：

1. **项目1: 固体的热容**
固体的德拜定理给出温度为$T$的固体的热容为
$$
C_V = 9V\rho k_B \biggl( {T\over\theta_D} \biggr)^3 \int_0^{\theta_D~/T}
      {x^4 e^x\over(e^x-1)^2} d x,
$$
这里$V$是固体的体积, $\rho$是原子数密度, $k_B$是玻尔兹曼常数, $\theta_D$是所谓的德拜温度, 是描述固体性质的一个量, 依赖于它们的密度和声速.

1. 写Python函数cv(T), 对给定的温度计算$C_V$, 样本是1000立方厘米的铝, 它的数密度为$\rho=6.022\times10^{28}\,\mathrm{m}^{-3}$， 德拜温度为$\theta_D=428\,$K.使用高斯积分来计算积分结果, 取$N=50$个样本点.
  
2. 利用你的函数画热容随温度的变化, 温度$T=5\,$K 到 $T=500\,$K.

2. **项目2: 伽马函数积分**
伽马函数$\Gamma(a)$是物理计算中常见的函数，

$$
\Gamma(a) = \int_0^\infty x^{a-1} e^{-x} d x.
$$

伽马函数没有解析解, 但是可以用积分计算给定$a$的函数值. 为得到精确结果则需要一些技巧.

1. $x$从0到5，分别计算$a=2,3,4$的被积函数$x^{a-1} e^{-x}$，画在同一张图上. 你会发现被积函数从0开始上升到最大值之后再下降.
2. 解析的说明最大值位于$x=a-1$.
3. 被积函数多数面积居于最大值附近, 为了获得更精确的伽马函数值，我们需要对这部分积分更仔细. 我们将从0到$\infty$的积分变换到0到1的积分, 但是这个变换会将峰值挤压到[0,1]范围的边界附近，对更准确的估计积分值不利. 我们可以做不同的变量代换使得峰值落于积分区域的中心, 约1/2. 我们将用到下面这个代换

$$
z = {x\over c+x}.
$$

当$x$取何值时这个变换能够使得$z=1/2$? 因而$c$取何值时使得被积函数的峰值落于$z=1/2$?
4. 现在, 使用上面的变量代换以及你选择的$c$值, 定义函数gamma(a)计算$a$取任意值时的伽马函数. 选择任何积分方法都可以. 用函数计算$\Gamma(\frac{3}{2})$来测试函数, 这个值是 $\frac12\sqrt{\pi}\simeq0.886$.
5. 当$a$是整数时, $\Gamma(a)$等于$a-1$的阶乘. 用你的函数计算$\Gamma(3)$, $\Gamma(6)$, 和 $\Gamma(10)$. 你的答案应该接近$2!=2$, $5!=120$, 和 $9!=362\,880$.

3. **项目3: 均匀带电圆环的电势和电场分布**
半径为$a$的均匀细圆环，环上带$4\pi\varepsilon_0q$的电荷, 求空间的电势和电场分布. 要求以等势线、等势面表示电势, 以箭头、场线或其他方式表示电场.

4. **项目4: 亥姆霍兹线圈**
   - 亥姆霍兹线圈由两个相同的线圈组成，线圈之间的距离与线圈的半径相等，通过两个线圈的电流方向相同、大小相等，
计算两个线圈之间的磁场。

5. **项目5: 均匀薄片的万有引力**
一块均匀的正方形金属板漂浮在空中静止不动:

![image.png](attachment:c1ada4fe-aa11-4fae-a5c1-150af6ce259b:image.png)

金属板边长为$10\,$m, 厚度可以忽略, 质量为10吨.

在正方形金属板中心垂直正上方距离$z$处一个质量为1kg的质点所受的万有引力，沿$z$轴方向的引力可以表示为

$$
F_z = G\sigma z \iint_{-L/2}^{L/2} {d x\,d y\over(x^2+y^2+z^2)^{3/2}}\,,
$$

其中$G=6.674\times10^{-11}\,\mathrm{m}^3\,\mathrm{kg}^{-1}\,\mathrm{s}^{-2}$ ，
是万有引力常数, $\sigma$是金属板上单位面积的质量.

1. 写程序计算并画出引力沿$z$方向的变化, $z$从0到10m. 试自己编写二重高斯积分代码, 每个轴都取100个样本点. (也可以使用scipy.integrate.nquad 函数)
2. 结果应该是一个平滑的曲线, 除了$z$非常小的时候力突然下降到0.

这个下降是计算导致的，并不是真实的结果. 解释这个现象产生的原因，找出部分消除或者至少减弱它的大小.

这个计算可以看作星系引力简化模型. 漩涡星系的大多数质量(比如银河系)都在通过银心的薄盘中, 银河系对外面天体的引力可以用我们这里的公式计算.
## 通用指南

* **编程语言:** 所有项目请使用Python 3.x完成
* **库:**
  - 基础库: `numpy`, `matplotlib`
  - 项目1: 可能需要`sympy`进行符号计算
  - 项目4: 可能需要`scipy.integrate`
* **代码风格:** 编写清晰、结构良好、有适当注释的代码
* **提交:**
  - 通过GitHub Classroom提交作业
  - 提交所有要求的代码和结果文件
  - 确保在截止日期前完成最终提交

